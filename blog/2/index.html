<!doctype html>
    <!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
    <!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
    <!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
    <!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]-->

    
      
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title>Rogerio Medeiros</title>
        <meta name="author" content="Rogerio Medeiros">
        
        <meta name="description" content="ruby rails git linux ubuntu lol rogerio medeiros rvm github argerim">
        
        <meta name="viewport" content="width=device-width">
        <link rel="canonical" href="http://argerim.github.io/blog/2">

        <link href='http://fonts.googleapis.com/css?family=Droid+Serif:400,400italic' rel='stylesheet' type='text/css'>
        <link href="http://fonts.googleapis.com/css?family=Droid+Sans" rel="stylesheet" type="text/css">

        
        <link href="/favicon.png" rel="icon">
        <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet">
        <link href="/atom.xml" rel="alternate" title="Rogerio Medeiros" type="application/atom+xml">
    </head>


    <body >

        <header id="header">
    <div class="row">
    <div class="col-xs-12 col-sm-8 col-md-4">
        <a href="/" class="site-title">Rogerio Medeiros</a>
    </div>
    <div class="col-xs-12 col-sm-4 col-md-8">
        <nav>
    <input type="checkbox" id="toggle">
    <label for="toggle" class="toggle" data-open="Main Menu" data-close="Close Menu"></label>
    <ul class="menu">
    <li><a href="/">Home</a></li>
    <li><a href="/about/">About</a></li>
    <li><a href="/blog/">Blog</a></li>
    <li><a href="/cv/">C.V.</a></li>
</ul>
</nav>

    </div>
</div>

</header>


        <div id="main-content">

            <!--[if lte IE 9]>
<div class="row upgrade-row">
    <div class="col-lg-12">
        <div class="upgrade">
            <i class="upgrade__icon fa fa-warning"></i>
            <h1 class="upgrade__title h6">Ohnoes!</h1>
            <p class="upgrade__text">
                Unfortunately, certain parts of this site may not display correctly in your version of Internet Explorer!<br>
                If possible, you should consider <a href="http://browsehappy.com/">upgrading your browser</a>.
            </p>
        </div>
    </div>
</div>
<!-- <![endif]-->


            

            <div class="row top-xs center-sm center-md center-lg site-wrapper">
                
                <div class="col-xs-12 col-sm-10 col-md-8 col-lg-8">
                
                        
    
        
        <article class="article article--index">
            <header class="article__header">
    
        <h1 class="h2 article__title">
            <a href="/blog/2012/04/14/continuando-a-saga-sobre-ajax-e-rails/">Continuando A Saga Sobre Ajax E Rails</a>
        </h1>
    

    
        <div class="article__meta clearfix">
            






    <time class="article__date pull-left" datetime="2012-04-14T20:49:00-03:00" pubdate><i class="fa fa-calendar"></i> Apr 14th, 2012</time>




            


            
                <a class="pull-right" href="http://argerim.github.io/blog/2012/04/14/continuando-a-saga-sobre-ajax-e-rails/#disqus_thread">
                    Comments <i class="fa fa-comment"></i>
                </a>
            
        </div>
    
</header>




    <p>Bom pessoal, demorei um pouco a fazer outro post devido ter me mudado para o Rio de Janeiro lol, trabalhando aqui agora. Não sei se posso falar a empresa que estou agora, ah vou falar rs. Bom fui contratado pela Helabs empresa do <a href="https://twitter.com/smergulhao">Sylvestre Mergulhão</a> e <a href="https://twitter.com/rafaelp">Rafael Lima</a>. Não tenho nem palavras para expressar a felicidade, que dizer tenho sim &ldquo;lol&rdquo;. Será um experiência única então vamos ao post.</p>

<p>Antes de começar esse post você deve seguir esse <a href="/blog/2012/03/31/basico-de-jquery-e-ajax-em-rails/">aqui</a> e esse <a href="/blog/2012/04/01/mensagem-de-erro-de-validacao-em-rails-como-um-helper/">outro</a></p>

<p>Depois de completar os 2 posts acima, iremos colocar nosso projeto ajax e rails para exibir as mensagens de erro ao criar um post, bem como a mensagem flash. Não é nada muito complicado so iremos fazer uma simples condição no arquivo /views/post/create.js.erb, adicionar uma nova div no form que irá exibir a mensagem de erro, adicionar a div para flash_notice na index de post e uma pequena alteração no controller de post ao criar um.</p>

<p>Vamos comerçar com a parte de mensagem de erro, hum bom vamos fazer tudo logo, assim era como estava o arquivo create.js.erb de post:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="err">$</span><span class="p">(</span><span class="s1">&#39;#comments&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">prepend</span><span class="p">(</span><span class="s1">&#39;&lt;%= escape_javascript(render(@comment)) %&gt;&#39;</span><span class="p">);</span>
</span><span class='line'><span class="err">$</span><span class="p">(</span><span class="s1">&#39;#comments &gt; li&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">first</span><span class="p">()</span><span class="o">.</span><span class="n">effect</span><span class="p">(</span><span class="s1">&#39;highlight&#39;</span><span class="p">,</span> <span class="p">{</span><span class="ss">color</span><span class="p">:</span> <span class="s1">&#39;cyan&#39;</span><span class="p">,</span> <span class="ss">mode</span><span class="p">:</span> <span class="s1">&#39;show&#39;</span><span class="p">},</span> <span class="mi">2000</span><span class="p">);</span>
</span><span class='line'><span class="err">$</span><span class="p">(</span><span class="s1">&#39;#comment_form &gt; form&#39;</span><span class="p">)</span><span class="o">[</span><span class="mi">0</span><span class="o">].</span><span class="n">reset</span><span class="p">();</span>
</span></code></pre></td></tr></table></div></figure>


<p>Alteramos para:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="o">&lt;</span><span class="sx">% if </span><span class="vi">@post</span><span class="o">.</span><span class="n">errors</span><span class="o">.</span><span class="n">any?</span> <span class="o">-</span><span class="sx">%&gt;</span>
</span><span class='line'><span class="sx">  /*Hide the flash notice div*/</span>
</span><span class='line'><span class="sx">  $(&#39;#flash_notice&#39;).hide(300);</span>
</span><span class='line'>
</span><span class='line'><span class="sx">  /*Update the html of the div post_errors with the new one*/</span>
</span><span class='line'><span class="sx">  $(&#39;#post_errors&#39;).html(&#39;&lt;%= escape_javascript(error_messages_for(@post))%&gt;</span><span class="s1">&#39;);</span>
</span><span class='line'>
</span><span class='line'><span class="s1">  /*Show the div post_errors*/</span>
</span><span class='line'><span class="s1">  $(&#39;</span><span class="c1">#post_errors&#39;).show(300);</span>
</span><span class='line'><span class="o">&lt;</span><span class="sx">% else </span><span class="o">-</span><span class="sx">%&gt;</span>
</span><span class='line'><span class="sx">  /*Hide the div post_errors*/</span>
</span><span class='line'><span class="sx">  $(&#39;#post_errors&#39;).hide(300);</span>
</span><span class='line'>
</span><span class='line'><span class="sx">  /*Update the html of the div flash_notice with the new one*/</span>
</span><span class='line'><span class="sx">  $(&#39;#flash_notice&#39;).html(&#39;&lt;%= escape_javascript(flash[:notice])%&gt;</span><span class="s1">&#39;);</span>
</span><span class='line'>
</span><span class='line'><span class="s1">  /*Show the flash_notice div*/</span>
</span><span class='line'><span class="s1">  $(&#39;</span><span class="c1">#flash_notice&#39;).show(300);</span>
</span><span class='line'>
</span><span class='line'>  <span class="err">$</span><span class="p">(</span><span class="s1">&#39;#posts&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">prepend</span><span class="p">(</span><span class="s1">&#39;&lt;%= escape_javascript(render(@post)) %&gt;&#39;</span><span class="p">);</span>
</span><span class='line'>  <span class="err">$</span><span class="p">(</span><span class="s1">&#39;#posts &gt; li&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">first</span><span class="p">()</span><span class="o">.</span><span class="n">effect</span><span class="p">(</span><span class="s1">&#39;highlight&#39;</span><span class="p">,</span> <span class="p">{</span><span class="ss">color</span><span class="p">:</span> <span class="s1">&#39;cyan&#39;</span><span class="p">,</span> <span class="ss">mode</span><span class="p">:</span> <span class="s1">&#39;show&#39;</span><span class="p">},</span> <span class="mi">2000</span><span class="p">);</span>
</span><span class='line'>  <span class="err">$</span><span class="p">(</span><span class="s1">&#39;#post_form &gt; form&#39;</span><span class="p">)</span><span class="o">[</span><span class="mi">0</span><span class="o">].</span><span class="n">reset</span><span class="p">();</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="sx">% end </span><span class="o">-%&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p>Aqui eu ja inclui a parte para exibir a mensagem flash, veja que agora nós temos uma condição, que verifica se algum erro foi lançado, se existe ele dar um hide na div de flash_notice, atualiza nossa div de post_erros com o helper que eu criei <a href="http://rogeriolol.heroku.com/blog/2012/04/01/mensagem-de-erro-de-validacao-em-rails-como-um-helper/">aqui</a> e exibe-a em seguida, senão ele da um hide na div de post_erros, atualiza a div da mensagem flash, mostra o objeto criado e limpa o formulário.</p>

<p>Com nosso arquivo create.js.erb no ponto, vamos adicionar as divs nas views, primeiro abra o form de post e deixe-o assim:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="o">&lt;</span><span class="sx">%= form_for(@post, :remote =</span><span class="o">&gt;</span> <span class="kp">true</span><span class="p">)</span> <span class="k">do</span> <span class="o">|</span><span class="n">f</span><span class="o">|</span> <span class="sx">%&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="sx">  &lt;div id= &quot;post_errors&quot; style=&quot;display:none&quot;&gt;</span><span class="o">&lt;</span><span class="sr">/div&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="sr">  &lt;div class=&quot;field&quot;&gt;</span>
</span><span class='line'><span class="sr">    &lt;%= f.label :title %&gt;&lt;br /</span><span class="o">&gt;</span>
</span><span class='line'>    <span class="o">&lt;</span><span class="sx">%= f.text_field :title %&gt;</span>
</span><span class='line'><span class="sx">  &lt;/div&gt;</span>
</span><span class='line'><span class="sx">  &lt;div class=</span><span class="s2">&quot;field&quot;</span><span class="o">&gt;</span>
</span><span class='line'>    <span class="o">&lt;</span><span class="sx">%= f.label :email %&gt;&lt;br /&gt;</span>
</span><span class='line'><span class="sx">    &lt;%=</span> <span class="n">f</span><span class="o">.</span><span class="n">text_field</span> <span class="ss">:email</span> <span class="sx">%&gt;</span>
</span><span class='line'><span class="sx">  &lt;/div&gt;</span>
</span><span class='line'>  <span class="o">&lt;</span><span class="n">div</span> <span class="n">class</span><span class="o">=</span><span class="s2">&quot;field&quot;</span><span class="o">&gt;</span>
</span><span class='line'>    <span class="o">&lt;</span><span class="sx">%= f.label :content %&gt;&lt;br /&gt;</span>
</span><span class='line'><span class="sx">    &lt;%=</span> <span class="n">f</span><span class="o">.</span><span class="n">text_area</span> <span class="ss">:content</span> <span class="sx">%&gt;</span>
</span><span class='line'><span class="sx">  &lt;/div&gt;</span>
</span><span class='line'>  <span class="o">&lt;</span><span class="n">div</span> <span class="n">class</span><span class="o">=</span><span class="s2">&quot;actions&quot;</span><span class="o">&gt;</span>
</span><span class='line'>    <span class="o">&lt;%=</span> <span class="n">f</span><span class="o">.</span><span class="n">submit</span> <span class="sx">%&gt;</span>
</span><span class='line'><span class="sx">  &lt;/div&gt;</span>
</span><span class='line'><span class="o">&lt;</span><span class="sx">% end </span><span class="o">%&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p>Nossa única alteração foi a inclusão da div para exibir as mensagens de erro.
Em seguida vamos abrir a index de post e incluir a div para a mensagem flash:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="o">&lt;</span><span class="n">div</span> <span class="nb">id</span><span class="o">=</span><span class="s2">&quot;flash_notice&quot;</span> <span class="n">style</span><span class="o">=</span><span class="s2">&quot;display:none&quot;</span><span class="o">&gt;&lt;</span><span class="sr">/div&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="sr">&lt;h1&gt;Posts&lt;/</span><span class="n">h1</span><span class="o">&gt;</span>
</span><span class='line'><span class="o">&lt;</span><span class="n">div</span> <span class="nb">id</span><span class="o">=</span><span class="s2">&quot;timer&quot;</span><span class="o">&gt;</span><span class="no">Rendered</span> <span class="ss">at</span><span class="p">:</span> <span class="o">&lt;</span><span class="sx">%= Time.now %&gt;&lt;/div&gt; </span>
</span><span class='line'><span class="sx"> </span>
</span><span class='line'><span class="sx">&lt;div id=</span><span class="s2">&quot;post_form&quot;</span><span class="o">&gt;</span>
</span><span class='line'>  <span class="o">&lt;</span><span class="sx">%= render &#39;form&#39; %&gt;</span>
</span><span class='line'><span class="sx">&lt;/div&gt;</span>
</span><span class='line'><span class="sx"> </span>
</span><span class='line'><span class="sx">&lt;ul id=</span><span class="s2">&quot;posts&quot;</span><span class="o">&gt;</span>
</span><span class='line'>  <span class="o">&lt;</span><span class="sx">%= render :partial =</span><span class="o">&gt;</span> <span class="vi">@posts</span><span class="o">.</span><span class="n">reverse</span> <span class="sx">%&gt;</span>
</span><span class='line'><span class="sx">&lt;/ul&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p>E finalizando abra o controller de post e deixei-o assim:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'>  <span class="k">def</span> <span class="nf">create</span>
</span><span class='line'>    <span class="vi">@post</span> <span class="o">=</span> <span class="no">Post</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">params</span><span class="o">[</span><span class="ss">:post</span><span class="o">]</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'>    <span class="n">respond_to</span> <span class="k">do</span> <span class="o">|</span><span class="nb">format</span><span class="o">|</span>
</span><span class='line'>      <span class="k">if</span> <span class="vi">@post</span><span class="o">.</span><span class="n">save</span>
</span><span class='line'>        <span class="nb">format</span><span class="o">.</span><span class="n">html</span> <span class="p">{</span> <span class="n">redirect_to</span> <span class="n">posts_url</span> <span class="p">}</span>
</span><span class='line'>        <span class="nb">format</span><span class="o">.</span><span class="n">json</span> <span class="p">{</span> <span class="n">render</span> <span class="ss">json</span><span class="p">:</span> <span class="vi">@post</span><span class="p">,</span> <span class="ss">status</span><span class="p">:</span> <span class="ss">:created</span><span class="p">,</span> <span class="ss">location</span><span class="p">:</span> <span class="vi">@post</span> <span class="p">}</span>
</span><span class='line'>        <span class="nb">format</span><span class="o">.</span><span class="n">js</span>
</span><span class='line'>        <span class="n">flash</span><span class="o">[</span><span class="ss">:notice</span><span class="o">]</span> <span class="o">=</span> <span class="s1">&#39;Post was successfully created.&#39;</span>
</span><span class='line'>      <span class="k">else</span>
</span><span class='line'>        <span class="nb">format</span><span class="o">.</span><span class="n">html</span> <span class="p">{</span> <span class="n">render</span> <span class="ss">action</span><span class="p">:</span> <span class="s2">&quot;index&quot;</span> <span class="p">}</span>
</span><span class='line'>        <span class="nb">format</span><span class="o">.</span><span class="n">json</span> <span class="p">{</span> <span class="n">render</span> <span class="ss">json</span><span class="p">:</span> <span class="vi">@post</span><span class="o">.</span><span class="n">errors</span><span class="p">,</span> <span class="ss">status</span><span class="p">:</span> <span class="ss">:unprocessable_entity</span> <span class="p">}</span>
</span><span class='line'>        <span class="nb">format</span><span class="o">.</span><span class="n">js</span>
</span><span class='line'>      <span class="k">end</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>  <span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>Fiz uma pequena alteção, pois como estava antes não exibia a mensagem flash. Agora você ja pode verificar se esta exibindo ou não as mensagens de erro e mensagem flash, lembrando que você deve seguir esse <a href="/blog/2012/03/31/basico-de-jquery-e-ajax-em-rails/">aqui</a> e esse <a href="/blog/2012/04/01/mensagem-de-erro-de-validacao-em-rails-como-um-helper/">outro</a>, antes de começar aqui.</p>

<p>Simples e fácil lol</p>



        </article>
        <hr>
    
        
        <article class="article article--index">
            <header class="article__header">
    
        <h1 class="h2 article__title">
            <a href="/blog/2012/04/01/mensagem-de-erro-de-validacao-em-rails-como-um-helper/">Mensagem De Erro De Validação Em Rails Como Um Helper</a>
        </h1>
    

    
        <div class="article__meta clearfix">
            






    <time class="article__date pull-left" datetime="2012-04-01T09:54:00-03:00" pubdate><i class="fa fa-calendar"></i> Apr 1st, 2012</time>




            


            
                <a class="pull-right" href="http://argerim.github.io/blog/2012/04/01/mensagem-de-erro-de-validacao-em-rails-como-um-helper/#disqus_thread">
                    Comments <i class="fa fa-comment"></i>
                </a>
            
        </div>
    
</header>




    <p>Estava eu tentando deixar mais dry meu código quando encontrei esse Episodio no <a href="http://asciicasts.com/episodes/211-validations-in-rails-3">asciicasts</a></p>

<p>Por padrao o rails gera mais ou menos isso dentro de cada form:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="o">&lt;</span><span class="sx">% if </span><span class="vi">@objeto</span><span class="o">.</span><span class="n">errors</span><span class="o">.</span><span class="n">any?</span> <span class="sx">%&gt;  </span>
</span><span class='line'><span class="sx">  &lt;div id=&quot;errorExplanation&quot;&gt;</span>
</span><span class='line'>    <span class="o">&lt;</span><span class="n">h2</span><span class="o">&gt;&lt;</span><span class="sx">%= pluralize(@objeto.errors.count, &quot;error&quot;) %&gt; prohibited this objeto from being saved:&lt;/h2&gt;  </span>
</span><span class='line'><span class="sx">    &lt;ul&gt;  </span>
</span><span class='line'><span class="sx">    &lt;% @objeto.errors.full_messages.each do |msg| %&gt;  </span>
</span><span class='line'><span class="sx">      &lt;li&gt;&lt;%=</span> <span class="n">msg</span> <span class="sx">%&gt;&lt;/li&gt;</span>
</span><span class='line'>    <span class="o">&lt;</span><span class="sx">% end %&gt;  </span>
</span><span class='line'><span class="sx">    &lt;/ul&gt;</span>
</span><span class='line'>  <span class="o">&lt;</span><span class="sr">/div&gt;  </span>
</span><span class='line'><span class="sr">  &lt;% end %&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p>Ai eu disse nossa que maravilha esse episodio. Só que pensando um pouco mais: Hum vou ter que criar uma pasta e depois uma view para fazer isso em meus projetos e ainda assim chamar dentro de cada form:</p>

<pre><code>&lt;%= render "shared/error_messages", :target =&gt; @user %&gt;
</code></pre>

<p>Dai eu disse: Hum vou fazer um helper para isso e chama-lo em cada form:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">def</span> <span class="nf">error_messages_for</span><span class="p">(</span><span class="n">target</span><span class="p">)</span>       
</span><span class='line'>  <span class="n">html</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</span><span class='line'>  <span class="k">if</span> <span class="n">target</span><span class="o">.</span><span class="n">errors</span><span class="o">.</span><span class="n">any?</span>         
</span><span class='line'>      <span class="n">html</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;&lt;div id=&#39;error_explanation&#39;&gt;</span>
</span><span class='line'><span class="s2">     &lt;h2&gt;</span><span class="si">#{</span><span class="n">pluralize</span><span class="p">(</span><span class="n">target</span><span class="o">.</span><span class="n">errors</span><span class="o">.</span><span class="n">count</span><span class="p">,</span> <span class="s1">&#39;error&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2"> prohibited this record from being saved:&lt;/h2&gt;  </span>
</span><span class='line'><span class="s2">     &lt;ul&gt;&quot;</span>
</span><span class='line'>      <span class="n">target</span><span class="o">.</span><span class="n">errors</span><span class="o">.</span><span class="n">full_messages</span><span class="o">.</span><span class="n">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">msg</span><span class="o">|</span>
</span><span class='line'>          <span class="n">html</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;&lt;li&gt;</span><span class="si">#{</span><span class="n">msg</span><span class="si">}</span><span class="s2">&lt;/li&gt;&quot;</span>
</span><span class='line'>      <span class="k">end</span>
</span><span class='line'>      <span class="n">html</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;&lt;/ul&gt;&lt;/div&gt;&quot;</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>  <span class="n">html</span><span class="o">.</span><span class="n">html_safe</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>Coloquei o nome de error_messages_for por que foi retirado do rails 3 senão me engano, bom alguem ja deve ter feito isso, mas fica ai a dica. Simples e fácil lol.</p>



        </article>
        <hr>
    
        
        <article class="article article--index">
            <header class="article__header">
    
        <h1 class="h2 article__title">
            <a href="/blog/2012/04/01/sobre-o-autor-do-blog/">Sobre O Autor Do Blog</a>
        </h1>
    

    
        <div class="article__meta clearfix">
            






    <time class="article__date pull-left" datetime="2012-04-01T07:20:00-03:00" pubdate><i class="fa fa-calendar"></i> Apr 1st, 2012</time>




            


            
                <a class="pull-right" href="http://argerim.github.io/blog/2012/04/01/sobre-o-autor-do-blog/#disqus_thread">
                    Comments <i class="fa fa-comment"></i>
                </a>
            
        </div>
    
</header>




    <p>NO SABADO PARA DOMINGO</p>

<p>Fim de semana chegou e estou bastante entusiasmado com a volta aos estudos com testes em rails, passei de sabado para domingo acordado tirando umas dúvidas e como sempre, muitas ideias aparecendo e uma delas ja pela manha de domingo, puts eu ainda acordado, foi fazer um post sobre minha pessoa, pricipalmente na parte de desenvolvimento. Então vamos lá.</p>

<p>UM POUCO SOBRE MINHA VIDA ANTES DA FACULDADE</p>

<p>Queria começar agradecendo aos meus pais por sempre darem do bom e do melhor, não so nos estudos, mas em tudo mesmo, não tenho do que reclamar, esse foi um dos motivos de passar por varias escolas, dentre elas não posso esquecer do colegio Marista São Pio X em Balsas-MA, foi uma infancia fantastica.
Até o fim do ensino médio, minha vida era so estudos, estudos mesmo, tinha o tempo de diversão, mas somente nas ferias rs. Tentando sempre dar o melhor de mim e mostrar aos meus pais que o que eles estavam fazendo era o melhor, apesar de todos falarem que era loucura o que estavam fazendo (Colocar eu e minha irma em outra cidade sozinhos para estudar, isso com 12 anos), que não iriamos dar valor. Fiz o melhor de mim, em todas as escolas que frequentei eu era um dos melhores alunos nao so nas nostas, como tambem no comportamento, algo que acabou refletindo na faculdade. Até aqui eu nao sabia nada de computadores, mas queria ser cientistas lol.</p>

<p>OS LONGOS E INESQUECIVEIS 5 ANOS DA FACULDADE</p>

<p>Antes de começar a faculdade eu mal sabia pegar em um mouse, escolhi o curso de Sistemas de Informação pela afinidade com a area de exatas, mas sabia qual era o focu do curso. Logo tudo que eu aprendi sobre desenvolvimento foi dentro da faculdade, onde apresentei meu TCC no ano de 2010. Estagiei em 4 empreas, as 2 primeiras dando aula de informatica basica, a 3ª e 4ª com desenvolvimento, comecei na 4ª empresa no inicio do ano de 2010, na qual depois de fazer uma pesquisa em qual linguagem iriamos desenvolver um sistema web (Java ou Ruby), o Dono acabou optando por Ruby, foi ai meu primeiro contato com a linguagem, cerca de 18 horas de aulas, agradeço a paciencia do <a href="https://twitter.com/lucasdecastro">Lucas de Castro</a>, que ministrou o curso, nossa enchi muito o saco dele, rs. Depois do curso tivemos que desenvolver o sistema web com framework Ruby on Rails, esse sistema nao terminamos, mas ainda consegui desenvolver nos 3 meses de estagio outros dois sistemas. Até aqui eu nao sabia nada de teste com ruby, nem mesmo com rails. Fiquei ate o meio do ano de 2010 desenvolvendo meu TCC, um pequeno aplicativo mobile usando JME, que por fim foi apresentado ainda no meio do ano.</p>

<p>O MEU PRIMEIRO EMPREGO</p>

<p>Como era periodo de eleição, pedi aos meu pais para ficar na minha cidade ate o termino da mesma. Depois voltei a capital (Teresina) e reiniciei os estudos em Ruby e Ruby on Rails, onde enchi muito o saco do pessoal do <a href="http://gurupi.org/">GuruPI (Grupo de Usuarios de Ruby do Piauí)</a>, principalmente no nosso grupo do google, em especial o <a href="https://twitter.com/caironoleto">Cairo Noleto</a> kkkkkkkkk. Surgiu uma oportunidade no grupo, enviei meu curriculo, la estava eu na entrevista lol, fiquei cerca de 3 meses em teste e 5 meses como efetivo. Desenvolvi 2 sistemas, como eu tinha tempo para estudar dentro da empresa, tive a iniciativa de começar a desenvolver os testes, em um deles fiz 80% dos testes dos controllers, mas acabei saindo da empresa por forças maiores, meus pais queriam me levar para minha cidade, e para eu ficar em Teresina, teria que me bancar. Fui a 2 entrevista e acabei ficando la, rs, foi muito engraçado a entrevista nesse empresa que me contratou, pegaram uma cadeira, me colocaram na frente do pc e eu ja estava ali lol, desenvolvendo, ja participei em N sistemas aqui e hoje alem de continuar desenvolvendo novos sistemas, faço a manutenção, na parte de codificar, do nosso principal sistema. Na empresa eu sou o menos experiente em desenvolvimento, mas acredito que seja o maior conhecedor na linguagem Ruby e framework Ruby on Rails. Estou hoje com 2 anos que conheço a linguagem e framework e com 6 meses que estudo testes, que seria desde quando entrei aqui, apesar do pessoal não praticar, algo que não dar para entender.</p>

<p>MEU EU lol</p>

<p>Não bebo (bebidas alcoolicas), não fumo, nunca usei drogas, sou catolico não muito praticante e amo minha Dondonzinha. Esse sou eu tentando sempre ser o melhor no que faço.</p>



        </article>
        <hr>
    
        
        <article class="article article--index">
            <header class="article__header">
    
        <h1 class="h2 article__title">
            <a href="/blog/2012/03/31/basico-de-jquery-e-ajax-em-rails/">Básico de Jquery e Ajax Em Rails</a>
        </h1>
    

    
        <div class="article__meta clearfix">
            






    <time class="article__date pull-left" datetime="2012-03-31T00:25:00-03:00" pubdate><i class="fa fa-calendar"></i> Mar 31st, 2012</time>




            


            
                <a class="pull-right" href="http://argerim.github.io/blog/2012/03/31/basico-de-jquery-e-ajax-em-rails/#disqus_thread">
                    Comments <i class="fa fa-comment"></i>
                </a>
            
        </div>
    
</header>




    <p>Este post tem por base o tutorial do <a href="http://notes.rehali.com/?p=97">rehali</a>.
Então antes de começar você deve fazer primeiro o post dele.
Seguindo sua linha de programação neste post irei implementar a funcionalidade de inserir os comentários em um artigo(post), com as mesmas funcionalidades que o rehali usou em seu <a href="http://notes.rehali.com/?p=97">artigo</a>: Jquery e Ajax.</p>

<p>Vamos as alterações no post do <a href="http://notes.rehali.com/?p=97">rehali</a>, para em seguida implementar a nova funcionalidade de adicionar comentarios ao artigo.</p>

<p>Abra o model de Post e adicione o seguinte metodo:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">def</span> <span class="nf">info</span>
</span><span class='line'>  <span class="s2">&quot;</span><span class="si">#{</span><span class="n">title</span><span class="si">}</span><span class="s2"> - [</span><span class="si">#{</span><span class="n">email</span><span class="si">}</span><span class="s2">]&quot;</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>Agora abrimos o arquivo views/posts/_post.html.erb e modificamos a segunda linha, ficando agora assim:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="o">&lt;</span><span class="sx">%= content_tag_for(:li, post) do %&gt;</span>
</span><span class='line'><span class="sx">  &lt;p class=</span><span class="s2">&quot;title&quot;</span><span class="o">&gt;&lt;</span><span class="sx">%= link_to post.info, post %&gt;&lt;/p&gt;</span>
</span><span class='line'><span class="sx">  &lt;p class=</span><span class="s2">&quot;content&quot;</span><span class="o">&gt;&lt;</span><span class="sx">%= truncate post.content %&gt;&lt;/p&gt;</span>
</span><span class='line'><span class="sx">  &lt;span class=</span><span class="s2">&quot;posted_at&quot;</span><span class="o">&gt;</span><span class="no">Posted</span> <span class="n">at</span> <span class="o">&lt;</span><span class="sx">%= time_ago_in_words(post.created_at) %&gt; ago.</span>
</span><span class='line'><span class="sx">  (&lt;%=</span> <span class="n">link_to</span> <span class="s1">&#39;Delete&#39;</span><span class="p">,</span> <span class="n">post</span><span class="p">,</span> <span class="ss">:confirm</span> <span class="o">=&gt;</span> <span class="s1">&#39;Are you sure?&#39;</span><span class="p">,</span> <span class="ss">:method</span> <span class="o">=&gt;</span> <span class="ss">:delete</span><span class="p">,</span> <span class="ss">:remote</span> <span class="o">=&gt;</span> <span class="kp">true</span><span class="sx">%&gt;)&lt;/span&gt;</span>
</span><span class='line'><span class="o">&lt;</span><span class="sx">% end </span><span class="o">%&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p>Aqui concluímos as alterações necessarias no post do <a href="http://notes.rehali.com/?p=97">rehali</a>, para colocarmos os comentarios. Mãos a obra lol.</p>

<p>Criamos o scaffold de comentarios e geramos sua tabela:</p>

<pre><code>rails g scaffold comment emai:string message:text references:post
rake db:migrate
</code></pre>

<p>Abra o model de post e o arquivo config/routes.rb e adicione respectivamente:</p>

<pre><code>has_many :comments #model post

resources :posts do #aquivo routes
  resources :comments
end
</code></pre>

<p>Em seguida crie a partial que irá mostrar os comentarios dentro da pagina do artigo com o nome de _comment.html.erb dentro da pasta views/comments com o seguinte código:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="o">&lt;</span><span class="sx">%= content_tag_for(:li, comment) do %&gt;</span>
</span><span class='line'><span class="sx">  &lt;p class=</span><span class="s2">&quot;title&quot;</span><span class="o">&gt;&lt;</span><span class="sx">%= comment.email %&gt;: &lt;%=</span> <span class="n">comment</span><span class="o">.</span><span class="n">message</span> <span class="sx">%&gt;&lt;/p&gt;</span>
</span><span class='line'>  <span class="o">&lt;</span><span class="n">span</span> <span class="n">class</span><span class="o">=</span><span class="s2">&quot;posted_at&quot;</span><span class="o">&gt;</span><span class="no">Posted</span> <span class="n">at</span> <span class="o">&lt;</span><span class="sx">%= time_ago_in_words(comment.created_at) %&gt; ago.</span>
</span><span class='line'><span class="sx">  (&lt;%=</span> <span class="n">link_to</span> <span class="s1">&#39;Delete&#39;</span><span class="p">,</span> <span class="n">comment</span><span class="p">,</span> <span class="ss">:confirm</span> <span class="o">=&gt;</span> <span class="s1">&#39;Are you sure?&#39;</span><span class="p">,</span> <span class="ss">:method</span> <span class="o">=&gt;</span> <span class="ss">:delete</span><span class="p">,</span> <span class="ss">:remote</span> <span class="o">=&gt;</span> <span class="kp">true</span><span class="sx">%&gt;)&lt;/span&gt;</span>
</span><span class='line'><span class="o">&lt;</span><span class="sx">% end </span><span class="o">%&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p>Continuando, crie os arquivos create.js.erb e destroy.js.erb dentro da pasta views/comments com o seguinte código, respectivamente:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="err">$</span><span class="p">(</span><span class="s1">&#39;#comments&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">prepend</span><span class="p">(</span><span class="s1">&#39;&lt;%= escape_javascript(render(@comment)) %&gt;&#39;</span><span class="p">);</span>
</span><span class='line'><span class="err">$</span><span class="p">(</span><span class="s1">&#39;#comments &gt; li&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">first</span><span class="p">()</span><span class="o">.</span><span class="n">effect</span><span class="p">(</span><span class="s1">&#39;highlight&#39;</span><span class="p">,</span> <span class="p">{</span><span class="ss">color</span><span class="p">:</span> <span class="s1">&#39;cyan&#39;</span><span class="p">,</span> <span class="ss">mode</span><span class="p">:</span> <span class="s1">&#39;show&#39;</span><span class="p">},</span> <span class="mi">2000</span><span class="p">);</span>
</span><span class='line'><span class="err">$</span><span class="p">(</span><span class="s1">&#39;#comment_form &gt; form&#39;</span><span class="p">)</span><span class="o">[</span><span class="mi">0</span><span class="o">].</span><span class="n">reset</span><span class="p">();</span>
</span></code></pre></td></tr></table></div></figure>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="err">$</span><span class="p">(</span><span class="s1">&#39;#&lt;%= dom_id(@comment) %&gt;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">effect</span><span class="p">(</span><span class="s1">&#39;highlight&#39;</span><span class="p">,</span> <span class="p">{</span><span class="ss">color</span><span class="p">:</span> <span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="ss">mode</span><span class="p">:</span> <span class="s1">&#39;hide&#39;</span><span class="p">},</span> <span class="mi">1200</span><span class="p">);</span>
</span></code></pre></td></tr></table></div></figure>


<p>Abra o form de comentarios e deixe-o assim:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="o">&lt;</span><span class="sx">%= form_for([@post, Comment.new], :remote =</span><span class="o">&gt;</span> <span class="kp">true</span><span class="p">)</span> <span class="k">do</span> <span class="o">|</span><span class="n">f</span><span class="o">|</span> <span class="sx">%&gt;</span>
</span><span class='line'><span class="sx">  &lt;div class=&quot;field&quot;&gt;</span>
</span><span class='line'>    <span class="o">&lt;</span><span class="sx">%= f.label :email %&gt;&lt;br /&gt;</span>
</span><span class='line'><span class="sx">    &lt;%=</span> <span class="n">f</span><span class="o">.</span><span class="n">text_field</span> <span class="ss">:email</span> <span class="sx">%&gt;</span>
</span><span class='line'><span class="sx">  &lt;/div&gt;</span>
</span><span class='line'>  <span class="o">&lt;</span><span class="n">div</span> <span class="n">class</span><span class="o">=</span><span class="s2">&quot;field&quot;</span><span class="o">&gt;</span>
</span><span class='line'>    <span class="o">&lt;</span><span class="sx">%= f.label :message %&gt;&lt;br /&gt;</span>
</span><span class='line'><span class="sx">    &lt;%=</span> <span class="n">f</span><span class="o">.</span><span class="n">text_area</span> <span class="ss">:message</span> <span class="sx">%&gt;</span>
</span><span class='line'><span class="sx">  &lt;/div&gt;</span>
</span><span class='line'>  <span class="o">&lt;</span><span class="n">div</span> <span class="n">class</span><span class="o">=</span><span class="s2">&quot;actions&quot;</span><span class="o">&gt;</span>
</span><span class='line'>    <span class="o">&lt;%=</span> <span class="n">f</span><span class="o">.</span><span class="n">submit</span> <span class="sx">%&gt;</span>
</span><span class='line'><span class="sx">  &lt;/div&gt;</span>
</span><span class='line'><span class="o">&lt;</span><span class="sx">% end </span><span class="o">%&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p>Em seguida vamos modificar o controller de comentarios, especificamente as actions create e destroy:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">class</span> <span class="nc">CommentsController</span> <span class="o">&lt;</span> <span class="no">ApplicationController</span>
</span><span class='line'>  <span class="n">respond_to</span> <span class="ss">:js</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">create</span>
</span><span class='line'>    <span class="vi">@post</span> <span class="o">=</span> <span class="no">Post</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">params</span><span class="o">[</span><span class="ss">:post_id</span><span class="o">]</span><span class="p">)</span>
</span><span class='line'>    <span class="vi">@comment</span> <span class="o">=</span> <span class="vi">@post</span><span class="o">.</span><span class="n">comments</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">params</span><span class="o">[</span><span class="ss">:comment</span><span class="o">]</span><span class="p">)</span>
</span><span class='line'>    <span class="n">respond_with</span><span class="p">(</span><span class="n">post_path</span><span class="p">(</span><span class="vi">@post</span><span class="p">))</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">destroy</span>
</span><span class='line'>    <span class="vi">@comment</span> <span class="o">=</span> <span class="no">Comment</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">params</span><span class="o">[</span><span class="ss">:id</span><span class="o">]</span><span class="p">)</span>
</span><span class='line'>    <span class="vi">@comment</span><span class="o">.</span><span class="n">destroy</span>
</span><span class='line'>    <span class="n">respond_with</span><span class="p">(</span><span class="n">post_path</span><span class="p">(</span><span class="vi">@comment</span><span class="o">.</span><span class="n">post</span><span class="p">))</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>E para quase finalizar vamos abrir a view show de post e deixa-la exatamente assim:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="o">&lt;</span><span class="n">div</span> <span class="nb">id</span><span class="o">=</span><span class="s2">&quot;timer&quot;</span><span class="o">&gt;</span><span class="no">Rendered</span> <span class="ss">at</span><span class="p">:</span> <span class="o">&lt;</span><span class="sx">%= Time.now %&gt;&lt;/div&gt; </span>
</span><span class='line'>
</span><span class='line'><span class="sx">&lt;p&gt;</span>
</span><span class='line'><span class="sx">  &lt;b&gt;Title:&lt;/b&gt;</span>
</span><span class='line'><span class="sx">  &lt;%=</span> <span class="vi">@post</span><span class="o">.</span><span class="n">title</span> <span class="sx">%&gt;</span>
</span><span class='line'><span class="sx">&lt;/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="nb">p</span><span class="o">&gt;</span>
</span><span class='line'>  <span class="o">&lt;</span><span class="n">b</span><span class="o">&gt;</span><span class="ss">Email</span><span class="p">:</span><span class="o">&lt;</span><span class="sr">/b&gt;</span>
</span><span class='line'><span class="sr">  &lt;%= @post.email %&gt;</span>
</span><span class='line'><span class="sr">&lt;/</span><span class="nb">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="nb">p</span><span class="o">&gt;</span>
</span><span class='line'>  <span class="o">&lt;</span><span class="n">b</span><span class="o">&gt;</span><span class="ss">Content</span><span class="p">:</span><span class="o">&lt;</span><span class="sr">/b&gt;</span>
</span><span class='line'><span class="sr">  &lt;%= @post.content %&gt;</span>
</span><span class='line'><span class="sr">&lt;/</span><span class="nb">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">h2</span><span class="o">&gt;</span><span class="no">Add</span> <span class="no">New</span> <span class="no">Comment</span><span class="o">&lt;</span><span class="sr">/h2&gt;</span>
</span><span class='line'><span class="sr">&lt;div id=&quot;comment_form&quot;&gt;</span>
</span><span class='line'><span class="sr"> &lt;%= render &#39;comments/</span><span class="n">form</span><span class="s1">&#39; %&gt;</span>
</span><span class='line'><span class="s1">&lt;/div&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="s1">&lt;ul id=&quot;comments&quot;&gt;</span>
</span><span class='line'><span class="s1"> &lt;%= render @post.comments.reverse %&gt;</span>
</span><span class='line'><span class="s1">&lt;/ul&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="s1">&lt;%= link_to &#39;</span><span class="no">Edit</span><span class="s1">&#39;, edit_post_path(@post) %&gt; |</span>
</span><span class='line'><span class="s1">&lt;%= link_to &#39;</span><span class="no">Back</span><span class="err">&#39;</span><span class="p">,</span> <span class="n">posts_path</span> <span class="o">%&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p>Quase tudo pronto. Aproveitando o css do artido do <a href="http://notes.rehali.com/?p=97">rehali</a>, abra o arquivo assets/stylesheets/comments.css.scss e adicione o seguinte código:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">html</span><span class="p">,</span> <span class="n">body</span> <span class="p">{</span>
</span><span class='line'>  <span class="n">font</span><span class="o">-</span><span class="ss">family</span><span class="p">:</span> <span class="no">Arial</span><span class="p">;</span>
</span><span class='line'>  <span class="n">font</span><span class="o">-</span><span class="ss">size</span><span class="p">:</span> <span class="mi">12</span><span class="n">px</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="n">textarea</span> <span class="p">{</span>
</span><span class='line'>  <span class="n">font</span><span class="o">-</span><span class="ss">family</span><span class="p">:</span> <span class="no">Arial</span><span class="p">;</span>
</span><span class='line'>  <span class="n">font</span><span class="o">-</span><span class="ss">size</span><span class="p">:</span> <span class="mi">12</span><span class="n">px</span><span class="p">;</span>
</span><span class='line'>  <span class="ss">width</span><span class="p">:</span> <span class="mi">500</span><span class="n">px</span><span class="p">;</span>
</span><span class='line'>  <span class="ss">height</span><span class="p">:</span> <span class="mi">100</span><span class="n">px</span><span class="p">;</span>
</span><span class='line'>  <span class="n">padding</span><span class="o">-</span><span class="ss">bottom</span><span class="p">:</span> <span class="mi">8</span><span class="n">px</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="o">.</span><span class="n">textfield</span><span class="p">{</span>
</span><span class='line'>  <span class="n">font</span><span class="o">-</span><span class="ss">family</span><span class="p">:</span> <span class="no">Arial</span><span class="p">;</span>
</span><span class='line'>  <span class="n">font</span><span class="o">-</span><span class="ss">size</span><span class="p">:</span> <span class="mi">14</span><span class="n">px</span><span class="p">;</span>
</span><span class='line'>  <span class="ss">width</span><span class="p">:</span> <span class="mi">300</span><span class="n">px</span><span class="p">;</span>
</span><span class='line'>  <span class="n">padding</span><span class="o">-</span><span class="ss">bottom</span><span class="p">:</span> <span class="mi">8</span><span class="n">px</span><span class="p">;</span>
</span><span class='line'>  <span class="ss">border</span><span class="p">:</span> <span class="mi">1</span><span class="n">px</span> <span class="n">solid</span> <span class="n">black</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="c1">#comments ul {</span>
</span><span class='line'>  <span class="ss">margin</span><span class="p">:</span> <span class="mi">0</span><span class="p">;</span>
</span><span class='line'>  <span class="ss">padding</span><span class="p">:</span> <span class="mi">0</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="c1">#comments li {</span>
</span><span class='line'>  <span class="n">margin</span><span class="o">-</span><span class="ss">left</span><span class="p">:</span> <span class="o">-</span><span class="mi">30</span><span class="n">pt</span><span class="p">;</span>
</span><span class='line'>  <span class="n">margin</span><span class="o">-</span><span class="ss">bottom</span><span class="p">:</span> <span class="mi">16</span><span class="n">px</span><span class="p">;</span>
</span><span class='line'>  <span class="ss">padding</span><span class="p">:</span> <span class="mi">8</span><span class="n">px</span><span class="p">;</span>
</span><span class='line'>  <span class="n">list</span><span class="o">-</span><span class="ss">style</span><span class="p">:</span> <span class="n">none</span><span class="p">;</span>
</span><span class='line'>  <span class="ss">border</span><span class="p">:</span> <span class="mi">1</span><span class="n">px</span> <span class="n">solid</span> <span class="c1">#ccc;</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="c1">#comments p {</span>
</span><span class='line'>  <span class="ss">margin</span><span class="p">:</span> <span class="mi">0</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="c1">#comments .title {</span>
</span><span class='line'>  <span class="n">font</span><span class="o">-</span><span class="ss">size</span><span class="p">:</span> <span class="mi">13</span><span class="n">px</span><span class="p">;</span>
</span><span class='line'>  <span class="n">font</span><span class="o">-</span><span class="ss">weight</span><span class="p">:</span> <span class="n">bold</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="c1">#comments .content {</span>
</span><span class='line'>  <span class="n">font</span><span class="o">-</span><span class="ss">size</span><span class="p">:</span> <span class="mi">12</span><span class="n">px</span><span class="p">;</span>
</span><span class='line'>  <span class="n">margin</span><span class="o">-</span><span class="ss">top</span><span class="p">:</span> <span class="mi">10</span><span class="n">px</span><span class="p">;</span>
</span><span class='line'>  <span class="n">margin</span><span class="o">-</span><span class="ss">bottom</span><span class="p">:</span> <span class="mi">10</span><span class="n">px</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="o">.</span><span class="n">posted_at</span> <span class="p">{</span>
</span><span class='line'>  <span class="n">font</span><span class="o">-</span><span class="ss">size</span><span class="p">:</span> <span class="mi">8</span><span class="n">pt</span><span class="p">;</span>
</span><span class='line'>  <span class="n">text</span><span class="o">-</span><span class="ss">decoration</span><span class="p">:</span> <span class="n">italic</span><span class="p">;</span>
</span><span class='line'>  <span class="n">margin</span><span class="o">-</span><span class="ss">bottom</span><span class="p">:</span> <span class="mi">8</span><span class="n">px</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="c1">#timer {</span>
</span><span class='line'>  <span class="n">font</span><span class="o">-</span><span class="ss">size</span><span class="p">:</span> <span class="mi">8</span><span class="n">pt</span><span class="p">;</span>
</span><span class='line'>  <span class="n">text</span><span class="o">-</span><span class="ss">decoration</span><span class="p">:</span> <span class="n">italic</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>Agora é so abrir o terminal e executar rails s. Simples e fácil lol.</p>



        </article>
        <hr>
    
        
        <article class="article article--index">
            <header class="article__header">
    
        <h1 class="h2 article__title">
            <a href="/blog/2012/03/29/preenchendo-combobox-com-cidades-de-acordo-com-o-estado-selecionado-em-rails/">Preenchendo ComboBox Com Cidades De Acordo Com O Estado Selecionado Em Rails</a>
        </h1>
    

    
        <div class="article__meta clearfix">
            






    <time class="article__date pull-left" datetime="2012-03-29T22:27:00-03:00" pubdate><i class="fa fa-calendar"></i> Mar 29th, 2012</time>




            


            
                <a class="pull-right" href="http://argerim.github.io/blog/2012/03/29/preenchendo-combobox-com-cidades-de-acordo-com-o-estado-selecionado-em-rails/#disqus_thread">
                    Comments <i class="fa fa-comment"></i>
                </a>
            
        </div>
    
</header>




    <p>Vamos criar nossa aplicação e para ir mais rapido o scaffold de city, state e user.</p>

<pre><code>rails new cities_by_state
rails g scaffold state name:string
rails g scaffold city name:string state:references
rails g scaffold user name:string city:references
rake db:migrate
rm public/index.html
</code></pre>

<p>Abra o arquivo config/routes.rb e defina a pagina de user como inicial:</p>

<pre><code>root :to =&gt; 'users#index'
</code></pre>

<p>Agora vamos starta a aplicação lol:</p>

<pre><code>rails s
</code></pre>

<p>Abra agora o arquivo db/seeds.rb e adicione as seguinte linhas, para popular nosso banco:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">states</span> <span class="o">=</span> <span class="no">State</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="o">[</span><span class="p">{</span><span class="ss">:name</span> <span class="o">=&gt;</span> <span class="s1">&#39;Piauí&#39;</span><span class="p">},</span> <span class="p">{</span><span class="ss">:name</span> <span class="o">=&gt;</span> <span class="s1">&#39;Maranhão&#39;</span><span class="p">},</span> <span class="p">{</span><span class="ss">:name</span> <span class="o">=&gt;</span> <span class="s1">&#39;Pernambuco&#39;</span><span class="p">}</span><span class="o">]</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'><span class="no">City</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="o">[</span>
</span><span class='line'>              <span class="p">{</span><span class="ss">:name</span> <span class="o">=&gt;</span> <span class="s1">&#39;Ribeiro Gonçalves&#39;</span><span class="p">,</span> <span class="ss">:state</span> <span class="o">=&gt;</span> <span class="n">states</span><span class="o">.</span><span class="n">first</span><span class="p">},</span>
</span><span class='line'>              <span class="p">{</span><span class="ss">:name</span> <span class="o">=&gt;</span> <span class="s1">&#39;Uruçuí&#39;</span><span class="p">,</span> <span class="ss">:state</span> <span class="o">=&gt;</span> <span class="n">states</span><span class="o">.</span><span class="n">first</span><span class="p">},</span>
</span><span class='line'>              <span class="p">{</span><span class="ss">:name</span> <span class="o">=&gt;</span> <span class="s1">&#39;Teresina&#39;</span><span class="p">,</span> <span class="ss">:state</span> <span class="o">=&gt;</span> <span class="n">states</span><span class="o">.</span><span class="n">first</span><span class="p">}</span>
</span><span class='line'>          <span class="o">]</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>Execute o seguinte comando no terminal:</p>

<pre><code>rake db:seed
</code></pre>

<p>Agora vamos abrir o arquivo _form.html.erb de user e colocar o combobox de state e city:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="o">&lt;</span><span class="n">div</span> <span class="n">class</span><span class="o">=</span><span class="s2">&quot;field&quot;</span><span class="o">&gt;</span>
</span><span class='line'>    <span class="o">&lt;</span><span class="sx">%= f.label :state %&gt;&lt;br /&gt;</span>
</span><span class='line'><span class="sx">    &lt;%=</span> <span class="n">collection_select</span><span class="p">(</span><span class="ss">:state</span> <span class="p">,</span><span class="ss">:id</span><span class="p">,</span> <span class="no">State</span><span class="o">.</span><span class="n">all</span><span class="p">,</span> <span class="ss">:id</span><span class="p">,</span> <span class="ss">:name</span><span class="p">,</span> <span class="ss">:include_blank</span> <span class="o">=&gt;</span> <span class="s1">&#39;SELECT A STATE&#39;</span><span class="p">)</span> <span class="sx">%&gt;</span>
</span><span class='line'><span class="sx">  &lt;/div&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">div</span> <span class="n">class</span><span class="o">=</span><span class="s2">&quot;field&quot;</span><span class="o">&gt;</span>
</span><span class='line'>   <span class="o">&lt;</span><span class="sx">%= f.label :city %&gt;&lt;br /&gt;</span>
</span><span class='line'><span class="sx">   &lt;%=</span> <span class="n">f</span><span class="o">.</span><span class="n">collection_select</span> <span class="ss">:city_id</span><span class="p">,</span> <span class="no">City</span><span class="o">.</span><span class="n">all</span><span class="p">,</span> <span class="ss">:id</span><span class="p">,</span> <span class="ss">:name</span><span class="p">,</span> <span class="ss">:include_blank</span> <span class="o">=&gt;</span> <span class="s1">&#39;SELECT A CITY&#39;</span> <span class="sx">%&gt;</span>
</span><span class='line'><span class="sx">&lt;/div&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p>Ainda não esta como queremos, então vamos fazer o metodo que irá buscar as cidades quando o combobox de estados for modificado, abrimos então o controller cities e adicionamos o seguinte código:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'>  <span class="k">def</span> <span class="nf">cities_by_state</span>
</span><span class='line'>    <span class="n">state_id</span> <span class="o">=</span> <span class="n">params</span><span class="o">[</span><span class="ss">:id</span><span class="o">].</span><span class="n">to_i</span>
</span><span class='line'>    <span class="n">cities</span> <span class="o">=</span> <span class="no">City</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="ss">:state_id</span> <span class="o">=&gt;</span> <span class="n">state_id</span><span class="p">)</span>
</span><span class='line'>    <span class="n">cty</span> <span class="o">=</span> <span class="o">[]</span>
</span><span class='line'>    <span class="n">cities</span><span class="o">.</span><span class="n">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">city</span><span class="o">|</span>
</span><span class='line'>      <span class="n">cty</span> <span class="o">&lt;&lt;</span> <span class="p">{</span><span class="ss">:id</span> <span class="o">=&gt;</span> <span class="n">city</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="ss">:n</span> <span class="o">=&gt;</span> <span class="n">city</span><span class="o">.</span><span class="n">name</span><span class="p">}</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>    <span class="n">render</span> <span class="ss">:json</span> <span class="o">=&gt;</span> <span class="p">{</span><span class="ss">:cty</span> <span class="o">=&gt;</span> <span class="n">cty</span><span class="o">.</span><span class="n">compact</span><span class="p">}</span><span class="o">.</span><span class="n">as_json</span>
</span><span class='line'>  <span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>Uma pequena modificação no arquivo config/routes.rb é necessária, pois temos que adicionar a rota para nosso metodo criado:</p>

<pre><code>match "/cities_by_state" =&gt; "cities#cities_by_state"
</code></pre>

<p>O metodo cities_by_state simplesmente recebe um parametro enviado via js e faz uma busca de todas as cidades em relação ao id do estado que foi enviado, retornando um arquivo json com o id e nome das cidades.</p>

<p>Quase finalizando criaremos agora nossos metodos js para fazer a busca e preenchimento ao modificar o combobox de estado. Adicione no final do arquivo _form.html.erb de user:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="o">&lt;</span><span class="n">script</span> <span class="n">type</span><span class="o">=</span><span class="s2">&quot;text/javascript&quot;</span><span class="o">&gt;</span>
</span><span class='line'>  <span class="err">$</span><span class="p">(</span><span class="n">document</span><span class="p">)</span><span class="o">.</span><span class="n">ready</span><span class="p">(</span><span class="n">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>   <span class="err">$</span><span class="p">(</span><span class="s2">&quot;#state_id&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">change</span><span class="p">(</span><span class="n">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>      <span class="n">getCitiesByState</span><span class="p">(</span><span class="s2">&quot;id=&quot;</span><span class="o">+</span><span class="err">$</span><span class="p">(</span><span class="s2">&quot;#state_id&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">val</span><span class="p">());</span>
</span><span class='line'>    <span class="p">});</span>
</span><span class='line'>  <span class="p">});</span>
</span><span class='line'>
</span><span class='line'>  <span class="n">function</span> <span class="n">getCitiesByState</span><span class="p">(</span><span class="nb">id</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="vg">$.</span><span class="n">getJSON</span><span class="p">(</span><span class="s2">&quot;/cities_by_state&quot;</span><span class="p">,</span> <span class="nb">id</span><span class="p">,</span> <span class="n">function</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>      <span class="n">var</span> <span class="n">options</span> <span class="o">=</span> <span class="s1">&#39;&lt;option value=&quot;&quot;&gt;SELECT A CITY&lt;/option&gt;&#39;</span><span class="p">;</span>
</span><span class='line'>      <span class="vg">$.</span><span class="n">each</span><span class="p">(</span><span class="n">j</span><span class="o">.</span><span class="n">cty</span><span class="p">,</span> <span class="n">function</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">item</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>        <span class="n">options</span> <span class="o">+=</span> <span class="s1">&#39;&lt;option value=&quot;&#39;</span> <span class="o">+</span> <span class="n">item</span><span class="o">.</span><span class="n">id</span> <span class="o">+</span> <span class="s1">&#39;&quot;&gt;&#39;</span> <span class="o">+</span> <span class="n">item</span><span class="o">.</span><span class="n">n</span> <span class="o">+</span> <span class="s1">&#39;&lt;/option&gt;&#39;</span><span class="p">;</span>
</span><span class='line'>      <span class="p">});</span>
</span><span class='line'>      <span class="err">$</span><span class="p">(</span><span class="s2">&quot;#user_city_id&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">html</span><span class="p">(</span><span class="n">options</span><span class="p">);</span>
</span><span class='line'>    <span class="p">});</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'><span class="o">&lt;</span><span class="sr">/script&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p>O primeiro metodo chama o segundo se o estado do combobox for modificado. O segundo metodo retorna as cidades referente ao estado selecionado no combobox e preenche o combobox com suas cidades.</p>

<p>Agora finalizando vamos modificar o combobox de cities para não exibir as cidades ao entar no form de usuarios, esperando o usuario selecionar primeiro um estado. O combobox deve ficar assim:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="o">&lt;</span><span class="n">div</span> <span class="n">class</span><span class="o">=</span><span class="s2">&quot;field&quot;</span><span class="o">&gt;</span>
</span><span class='line'>   <span class="o">&lt;</span><span class="sx">%= f.label :city %&gt;&lt;br /&gt;</span>
</span><span class='line'><span class="sx">   &lt;%=</span> <span class="n">f</span><span class="o">.</span><span class="n">collection_select</span> <span class="ss">:city_id</span><span class="p">,</span> <span class="o">[]</span><span class="p">,</span> <span class="ss">:id</span><span class="p">,</span> <span class="ss">:name</span><span class="p">,</span> <span class="ss">:include_blank</span> <span class="o">=&gt;</span> <span class="s1">&#39;SELECT FIRST STATE&#39;</span> <span class="sx">%&gt;</span>
</span><span class='line'><span class="sx">&lt;/div&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p>Simples e fácil lol.</p>



        </article>
        <hr>
    
        
        <article class="article article--index">
            <header class="article__header">
    
        <h1 class="h2 article__title">
            <a href="/blog/2012/03/27/algumas-dicas-ao-usar-rails-e-rspec/">Algumas Dicas Ao Usar Rails E Rspec</a>
        </h1>
    

    
        <div class="article__meta clearfix">
            






    <time class="article__date pull-left" datetime="2012-03-27T13:23:00-03:00" pubdate><i class="fa fa-calendar"></i> Mar 27th, 2012</time>




            


            
                <a class="pull-right" href="http://argerim.github.io/blog/2012/03/27/algumas-dicas-ao-usar-rails-e-rspec/#disqus_thread">
                    Comments <i class="fa fa-comment"></i>
                </a>
            
        </div>
    
</header>




    <p>Antes de começar seria bom dar uma olhada <a href="/blog/2012/03/15/preparando-sua-aplicacao-rails-para-testes-com-guard-e-rspec">nesse meu post</a></p>

<p>Esperando que você tenha lido o post do link acima, vamos fazer uma pequena modificação no arquivo gemfile, ficando agora assim:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">group</span> <span class="ss">:development</span><span class="p">,</span> <span class="ss">:test</span> <span class="k">do</span>
</span><span class='line'>  <span class="n">gem</span> <span class="s2">&quot;rspec-rails&quot;</span><span class="p">,</span> <span class="s2">&quot;~&gt; 2.6&quot;</span>
</span><span class='line'>  <span class="n">gem</span> <span class="s1">&#39;guard&#39;</span>
</span><span class='line'>  <span class="n">gem</span> <span class="s1">&#39;guard-rspec&#39;</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>Agora o porque de ter adicionado o :development, foi simplesmente para termos alguns benefícios do Rspec, onde ao criarmos um model, controller ou o próprio scaffold, também será gerado seus arquivos de teste.</p>

<p>Faça os seguintes comandos e veja as saídas:</p>

<pre><code>rails g controller post index
rails g model post title:string body:text
rails g scaffold post title:string body:text
</code></pre>

<p>Se tudo ocorreu como o esperado você dete ter visto pelo menos esta saída:</p>

<pre><code>invoke  active_record
create    db/migrate/20120327143756_create_posts.rb
create    app/models/post.rb
invoke    rspec
create      spec/models/post_spec.rb
</code></pre>

<p>Observe que foi criado um arquivo post_spec.rb dentro da pasta spec/models.</p>

<p>Pegando como exemplo somente o comando de criação do model, se executarmos o comando guard, devemos ter a seguinte saída:</p>

<pre><code>Pending:
Post add some examples to (or delete) /home/rogerio/projetos/rspec_test/spec/models/post_spec.rb
    # No reason given
    # ./spec/models/post_spec.rb:4

Finished in 0.00026 seconds
1 example, 0 failures, 1 pending
Bye bye...
</code></pre>

<p>Acima ele diz que existe uma pendência, isto é claro, pois temos somente um arquivo base para criarmos nossos testes, então vamos colocar uma simples validação dentro do model post:</p>

<pre><code>validate_presence_of :title
</code></pre>

<p>Essa validação diz que não é possivel cadastrar um post com título em branco, vamos fazer o teste para criar um Post.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">describe</span> <span class="no">Post</span> <span class="k">do</span>
</span><span class='line'>  <span class="n">it</span> <span class="s2">&quot;should be valid&quot;</span> <span class="k">do</span>
</span><span class='line'>      <span class="vi">@post</span> <span class="o">=</span> <span class="no">Post</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="ss">:title</span> <span class="o">=&gt;</span> <span class="s2">&quot;My first Post&quot;</span><span class="p">)</span>
</span><span class='line'>      <span class="vi">@post</span><span class="o">.</span><span class="n">should</span> <span class="n">be_valid</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>Agora vamos preparar nosso banco de dados para executar o teste, abra o terminal e execute o comando:</p>

<pre><code>rake db:migrate RAILS_ENV=test
</code></pre>

<p>Logo em seguida execute o comando guard, certamente nosso teste irá passar, vamos fazer a seguinte modificação na validação, de modo que irá quebrar nosso teste, adicione depois do campo title, o body, ficando assim:</p>

<pre><code>validate_presence_of :title, :body
</code></pre>

<p>Agora nosso teste não esta passando, então vamos arrumar isso, ficando agora assim:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">describe</span> <span class="no">Post</span> <span class="k">do</span>
</span><span class='line'>  <span class="n">it</span> <span class="s2">&quot;should be valid&quot;</span> <span class="k">do</span>
</span><span class='line'>      <span class="vi">@post</span> <span class="o">=</span> <span class="no">Post</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="ss">:title</span> <span class="o">=&gt;</span> <span class="s2">&quot;My first Post&quot;</span><span class="p">,</span> <span class="ss">:body</span> <span class="o">=&gt;</span> <span class="s1">&#39;Help me&#39;</span><span class="p">)</span>
</span><span class='line'>      <span class="vi">@post</span><span class="o">.</span><span class="n">should</span> <span class="n">be_valid</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>Vamos adicionar um teste que verifica se o title esta nil:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">describe</span> <span class="no">Post</span> <span class="k">do</span>
</span><span class='line'>  <span class="n">it</span> <span class="s2">&quot;should be invalid without a title&quot;</span> <span class="k">do</span>
</span><span class='line'>      <span class="vi">@post</span> <span class="o">=</span> <span class="no">Post</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="ss">:title</span> <span class="o">=&gt;</span> <span class="kp">nil</span><span class="p">,</span> <span class="ss">:body</span> <span class="o">=&gt;</span> <span class="s2">&quot;Help me&quot;</span><span class="p">)</span>
</span><span class='line'>      <span class="c1">#@post.should be_invalid(:title) uma pequena correção aqui bem observada pelo</span>
</span><span class='line'>      <span class="c1">#companheiro de trabalho Pedro Nascimento, be_invalid é usando com callbacks, o correto</span>
</span><span class='line'>      <span class="c1">#é assim:</span>
</span><span class='line'>      <span class="vi">@post</span><span class="o">.</span><span class="n">should_not</span> <span class="n">be_valid</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>E este é nosso arquivo final:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">describe</span> <span class="no">Post</span> <span class="k">do</span>
</span><span class='line'>  <span class="n">it</span> <span class="s2">&quot;should be valid&quot;</span> <span class="k">do</span>
</span><span class='line'>      <span class="vi">@post</span> <span class="o">=</span> <span class="no">Post</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="ss">:title</span> <span class="o">=&gt;</span> <span class="s2">&quot;My first Post&quot;</span><span class="p">,</span> <span class="ss">:body</span> <span class="o">=&gt;</span> <span class="s2">&quot;Help me&quot;</span><span class="p">)</span>
</span><span class='line'>      <span class="vi">@post</span><span class="o">.</span><span class="n">should</span> <span class="n">be_valid</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="n">it</span> <span class="s2">&quot;should be invalid without a title&quot;</span> <span class="k">do</span>
</span><span class='line'>      <span class="vi">@post</span> <span class="o">=</span> <span class="no">Post</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="ss">:title</span> <span class="o">=&gt;</span> <span class="kp">nil</span><span class="p">,</span> <span class="ss">:body</span> <span class="o">=&gt;</span> <span class="s2">&quot;Help me&quot;</span><span class="p">)</span>
</span><span class='line'>      <span class="c1">#@post.should be_invalid(:title) uma pequena correção aqui bem observada pelo</span>
</span><span class='line'>      <span class="c1">#companheiro de trabalho Pedro Nascimento, be_invalid é usando com callbacks, o correto</span>
</span><span class='line'>      <span class="c1">#é assim:</span>
</span><span class='line'>      <span class="vi">@post</span><span class="o">.</span><span class="n">should_not</span> <span class="n">be_valid</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>Ficam as dicas:</p>

<p>Ao ver o before em um teste fique sabendo que ele contem condições que serão executadas antes do teste.</p>

<p>O it é sempre uma especificação, normalmente validando algo, que sempre esta associada a um describe.</p>

<p>O describe contem uma ou várias especificações, validando no final um determinado contexto.</p>

<p>Tente fazer seus teste sempre em inglês.</p>

<p>Faça primeiro os testes, depois code.</p>

<p>Além disso, poderiamos deixar o código mais dry usando o remarkable ou shoulda, que podemos integrar com o rspec, facilitando quando vamos fazer validação, um exemplo esta logo abaixo de como seria escrito o teste para validar o título do post:</p>

<pre><code>it {should validate_presence_of :title }
</code></pre>

<p>Simples e fácil lol.</p>



        </article>
        <hr>
    
        
        <article class="article article--index">
            <header class="article__header">
    
        <h1 class="h2 article__title">
            <a href="/blog/2012/03/19/devise-bloqueando-o-acesso-do-usuario-ao-sistema/">Devise - Bloqueando O Acesso Do Usuário Ao Sistema</a>
        </h1>
    

    
        <div class="article__meta clearfix">
            






    <time class="article__date pull-left" datetime="2012-03-19T19:02:00-03:00" pubdate><i class="fa fa-calendar"></i> Mar 19th, 2012</time>




            


            
                <a class="pull-right" href="http://argerim.github.io/blog/2012/03/19/devise-bloqueando-o-acesso-do-usuario-ao-sistema/#disqus_thread">
                    Comments <i class="fa fa-comment"></i>
                </a>
            
        </div>
    
</header>




    <p>O Devise tem um método chamado active_for_authentication, o qual dá permissão ao usuário de logar no sistema.
Vamos sobrescreve-lo no model User e assim termos o poder de bloquear um usuário.
Antes de ir ao código vamos escrever o teste:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="c1"># Test</span>
</span><span class='line'>
</span><span class='line'><span class="nb">require</span> <span class="s1">&#39;spec_helper&#39;</span>
</span><span class='line'>
</span><span class='line'><span class="n">describe</span> <span class="no">Devise</span><span class="o">::</span><span class="no">SessionsController</span> <span class="k">do</span>
</span><span class='line'>  <span class="kp">include</span> <span class="no">Devise</span><span class="o">::</span><span class="no">TestHelpers</span>
</span><span class='line'>
</span><span class='line'>  <span class="n">before</span> <span class="k">do</span>
</span><span class='line'>    <span class="vi">@user</span> <span class="o">=</span> <span class="no">Factory</span><span class="p">(</span><span class="ss">:confirmed_user</span><span class="p">,</span> <span class="ss">:active</span> <span class="o">=&gt;</span> <span class="kp">false</span><span class="p">)</span>
</span><span class='line'>    <span class="n">request</span><span class="o">.</span><span class="n">env</span><span class="o">[</span><span class="s2">&quot;devise.mapping&quot;</span><span class="o">]</span> <span class="o">=</span> <span class="no">Devise</span><span class="o">.</span><span class="n">mappings</span><span class="o">[</span><span class="ss">:user</span><span class="o">]</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="n">it</span> <span class="s1">&#39;will not sign user in if not active&#39;</span> <span class="k">do</span>
</span><span class='line'>    <span class="n">post</span> <span class="ss">:create</span><span class="p">,</span> <span class="ss">:user</span> <span class="o">=&gt;</span> <span class="p">{</span><span class="ss">:password</span> <span class="o">=&gt;</span> <span class="s2">&quot;password&quot;</span><span class="p">,</span> <span class="ss">:email</span> <span class="o">=&gt;</span> <span class="vi">@user</span><span class="o">.</span><span class="n">email</span><span class="p">}</span>
</span><span class='line'>    <span class="n">controller</span><span class="o">.</span><span class="n">should_not</span> <span class="n">be_user_active</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>O teste simplesmente nos mostra uma mensagem se o usuario não tiver permissão de login, agora vamos coda.
Criamos uma migration adicionando um campo com o nome de active do tipo boolean:</p>

<pre><code>rails g migration Add_active_To_User active:boolean
rails rake db:migrate
</code></pre>

<p>Agora adicionamos o método active_for_authentication, bem como o inactive_message, que irá exibir uma mensagem se o usuário estiver bloquedo. Isso dentro do model User, não esqueça.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="c1"># User model</span>
</span><span class='line'>
</span><span class='line'><span class="k">def</span> <span class="nf">active_for_authentication?</span>
</span><span class='line'>  <span class="n">active</span>
</span><span class='line'><span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="k">def</span> <span class="nf">inactive_message</span>
</span><span class='line'>  <span class="s2">&quot;Sorry, this account has been deactivated.&quot;</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>Simples e fácil, agora é so fazer uma action para ficar mudando de false para true o campo active.</p>



        </article>
        <hr>
    
        
        <article class="article article--index">
            <header class="article__header">
    
        <h1 class="h2 article__title">
            <a href="/blog/2012/03/15/preparando-sua-aplicacao-rails-para-testes-com-guard-e-rspec/">Preparando Sua Aplicação Rails Para Testes Com Guard e Rspec</a>
        </h1>
    

    
        <div class="article__meta clearfix">
            






    <time class="article__date pull-left" datetime="2012-03-15T11:36:00-03:00" pubdate><i class="fa fa-calendar"></i> Mar 15th, 2012</time>




            


            
                <a class="pull-right" href="http://argerim.github.io/blog/2012/03/15/preparando-sua-aplicacao-rails-para-testes-com-guard-e-rspec/#disqus_thread">
                    Comments <i class="fa fa-comment"></i>
                </a>
            
        </div>
    
</header>




    <p>Guard</p>

<p>É uma ferramente de linha de comando que nos ajuda a lidar com eventos sobre modificações em arquivos.</p>

<p>Rspec</p>

<p>É um framework BDD, feito em Ruby, que nos permite escrever testes.</p>

<p>Vamos começar, criamos nossa aplicação, logo em seguida abrimos o arquivo Gemfile e adicionamos o seguinte grupo:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">group</span> <span class="ss">:test</span> <span class="k">do</span>
</span><span class='line'>  <span class="n">gem</span> <span class="s2">&quot;rspec-rails&quot;</span><span class="p">,</span> <span class="s2">&quot;~&gt; 2.6&quot;</span>
</span><span class='line'>  <span class="n">gem</span> <span class="s1">&#39;guard&#39;</span>
</span><span class='line'>  <span class="n">gem</span> <span class="s1">&#39;guard-rspec&#39;</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>Abra o terminal e execute o comando:</p>

<pre><code>bundle install
</code></pre>

<p>Ainda com terminal aberto, com os respectivos comandos, logo abaixo, vamos gerar uma arquivo Guardfile e o diretório spec com os arquivos necessário para começar com os testes.</p>

<pre><code>guard init
rails generate rspec:install
</code></pre>

<p>Fácil não ? Sua aplicação agora esta pronta para aceitar seus testes, comece a escrevê-los</p>

<p>Para dar inicio à ferramenta guard é so ir até a raiz da aplicação Rails e executar o seguinte comando:</p>

<pre><code>guard
</code></pre>

<p>Simple e fácil lol.</p>



        </article>
        <hr>
    
        
        <article class="article article--index">
            <header class="article__header">
    
        <h1 class="h2 article__title">
            <a href="/blog/2012/03/14/criando-sua-primeira-gem-parte-3/">Criando Sua Primeira Gem Parte 3</a>
        </h1>
    

    
        <div class="article__meta clearfix">
            






    <time class="article__date pull-left" datetime="2012-03-14T11:45:00-03:00" pubdate><i class="fa fa-calendar"></i> Mar 14th, 2012</time>




            


            
                <a class="pull-right" href="http://argerim.github.io/blog/2012/03/14/criando-sua-primeira-gem-parte-3/#disqus_thread">
                    Comments <i class="fa fa-comment"></i>
                </a>
            
        </div>
    
</header>




    <p>Agora entramos na parte de teste, então porque fazer testes ?
Teste é extremamente importante, pois não só garante que seu código funcione, como ajuda aos outros a saberem que sua gem irá fazer o serviço lol.</p>

<p>Antes de começar dê uma olhada <a href="/blog/2012/03/06/criando-sua-primeira-gem-parte-1/">Criando Sua Primeira Gem Parte 1</a></p>

<p>Começamos adicionando um arquivo com o nome Rakefile, que nos permitirá automatizar os testes:</p>

<pre><code>touch Rakefile
</code></pre>

<p>Agora colocamos um pouco de código no arquivo:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="nb">require</span> <span class="s1">&#39;rake/testtask&#39;</span>
</span><span class='line'>
</span><span class='line'><span class="no">Rake</span><span class="o">::</span><span class="no">TestTask</span><span class="o">.</span><span class="n">new</span> <span class="k">do</span> <span class="o">|</span><span class="n">t</span><span class="o">|</span>
</span><span class='line'>  <span class="n">t</span><span class="o">.</span><span class="n">libs</span> <span class="o">&lt;&lt;</span> <span class="s1">&#39;test&#39;</span>
</span><span class='line'><span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="n">desc</span> <span class="s2">&quot;Run tests&quot;</span>
</span><span class='line'><span class="n">task</span> <span class="ss">:default</span> <span class="o">=&gt;</span> <span class="ss">:test</span>
</span></code></pre></td></tr></table></div></figure>


<p>E agora vamos criar uma pasta com o nome test e um arquivo como o nome test_miguxo_gem.rb:</p>

<pre><code>mkdir test
cd test
touch test_miguxo_gem.rb
</code></pre>

<p>Colocamos um pouco de código no arquivo test_miguxo_gem.rb:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="c1"># -*- coding: utf-8 -*-</span>
</span><span class='line'><span class="nb">require</span> <span class="s1">&#39;test/unit&#39;</span>
</span><span class='line'><span class="nb">require</span> <span class="s1">&#39;miguxo_gem&#39;</span>
</span><span class='line'>
</span><span class='line'><span class="k">class</span> <span class="nc">MiguxoTest</span> <span class="o">&lt;</span> <span class="no">Test</span><span class="o">::</span><span class="no">Unit</span><span class="o">::</span><span class="no">TestCase</span>
</span><span class='line'>  <span class="k">def</span> <span class="nf">test_dmitrynix_miguxo</span>
</span><span class='line'>    <span class="n">assert_equal</span> <span class="s2">&quot;Olá Miguxito Mestre em Testes lol&quot;</span><span class="p">,</span>
</span><span class='line'>      <span class="no">Miguxo</span><span class="o">.</span><span class="n">xaudacao</span><span class="p">(</span><span class="ss">:dmitrynix</span><span class="p">)</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">test_caironoleto_miguxo</span>
</span><span class='line'>    <span class="n">assert_equal</span> <span class="s2">&quot;Olá Miguxito Mestre em Rails lol&quot;</span><span class="p">,</span>
</span><span class='line'>      <span class="no">Miguxo</span><span class="o">.</span><span class="n">xaudacao</span><span class="p">(</span><span class="ss">:caironoleto</span><span class="p">)</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">test_infoslack_miguxo</span>
</span><span class='line'>    <span class="n">assert_equal</span> <span class="s2">&quot;Olá Miguxito Mestre em Sugurança lol&quot;</span><span class="p">,</span>
</span><span class='line'>      <span class="no">Miguxo</span><span class="o">.</span><span class="n">xaudacao</span><span class="p">(</span><span class="ss">:infoslack</span><span class="p">)</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">test_leandrosales_miguxo</span>
</span><span class='line'>    <span class="n">assert_equal</span> <span class="s2">&quot;Olá Miguxito Mestre em Sacanagem lol&quot;</span><span class="p">,</span>
</span><span class='line'>      <span class="no">Miguxo</span><span class="o">.</span><span class="n">xaudacao</span><span class="p">(</span><span class="ss">:leandrosales</span><span class="p">)</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">test_weldyss_miguxo</span>
</span><span class='line'>    <span class="n">assert_equal</span> <span class="s2">&quot;Olá Miguxito Chefe lol&quot;</span><span class="p">,</span>
</span><span class='line'>      <span class="no">Miguxo</span><span class="o">.</span><span class="n">xaudacao</span><span class="p">(</span><span class="ss">:weldyss</span><span class="p">)</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">test_any_ola_miguxo</span>
</span><span class='line'>    <span class="n">assert_equal</span> <span class="s2">&quot;Olá Miguxito&quot;</span><span class="p">,</span>
</span><span class='line'>      <span class="no">Miguxo</span><span class="o">.</span><span class="n">xaudacao</span><span class="p">(</span><span class="s2">&quot;rails&quot;</span><span class="p">)</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>Nossa nova estrutura deve ficar assim:</p>

<pre><code>% Nova estrutura
.
├── Rakefile
├── miguxo_gem.gemspec
├── lib
│   ├── miguxo
│   │   └── miguxito.rb
│   └── miguxo_gem.rb
└── test
    └── test_miguxo_gem.rb
</code></pre>

<p>Pronto agora sua gem já esta com os testes, vamos executar, abra o terminal e digite:</p>

<pre><code>rake test
</code></pre>

<p>A saída deve ser a seguinte:</p>

<pre><code>Run options: 

# Running tests:

......

Finished tests in 0.000863s, 6950.5423 tests/s, 6950.5423 assertions/s.

6 tests, 6 assertions, 0 failures, 0 errors, 0 skips
</code></pre>

<p>Simples e fácil lol.</p>



        </article>
        <hr>
    
        
        <article class="article article--index">
            <header class="article__header">
    
        <h1 class="h2 article__title">
            <a href="/blog/2012/03/13/instalacao-lua-ubuntu-11-dot-10/">Instalação Lua Ubuntu 11.10</a>
        </h1>
    

    
        <div class="article__meta clearfix">
            






    <time class="article__date pull-left" datetime="2012-03-13T15:49:00-03:00" pubdate><i class="fa fa-calendar"></i> Mar 13th, 2012</time>




            


            
                <a class="pull-right" href="http://argerim.github.io/blog/2012/03/13/instalacao-lua-ubuntu-11-dot-10/#disqus_thread">
                    Comments <i class="fa fa-comment"></i>
                </a>
            
        </div>
    
</header>




    <p>A empresa na qual trabalho resolveu partir para o desenvolvimento em TV Digital.
Resolvi começar a estudar sobre a linguagem que iremos usar.
Até o momento nenhuma dificuldade, logo abaixo irei mostrar como instalar no linux, algo que foi bem simples, mas antes uma breve descrição sobre a linguagem.</p>

<pre><code>"Lua é uma linguagem de programação leve e poderosa. Projetada por uma equipe do 
laboratório Lablua da PUC-Rio, nasceu e cresceu dentro do Tecgraf desde 1993.
Lua é FOSS, registrada sob a licença GNU/GPL. Em um vislumbre superficial Lua 
pode parecer uma linguagem de mercado reduzido, mas esta é uma primeira impressão
equivocada. Isto ocorre porque Lua é uma linguagem internacional. Lua é muito 
usada como linguagem de extensão para motores de jogos e está agora ganhando 
força no mercado de aplicações web devido ao Projeto Kepler. Além da 
PUC-Rio e da Petrobrás, um exemplo de companhia que usa amplamente a linguagem
é a Lucas Arts."
</code></pre>

<p>Começando a instalação, abra o terminal e digite os seguintes comandos:</p>

<pre><code>sudo apt-get update
sudo apt-get install liblua5.1-0 liblua5.1-0-dev lua5.1
</code></pre>

<p>Vamos testar, digite no terminal: lua, deve aparecer a seguinte saída:</p>

<pre><code>Lua 5.1.4  Copyright (C) 1994-2008 Lua.org, PUC-Rio
&gt; 
</code></pre>

<p>Vamos ao nosso velho &lsquo;hello word&rsquo;</p>

<pre><code>print 'hello word'
</code></pre>

<p>Se tudo deu certo ele deve imprimir &ldquo;hello word&rdquo; logo abaixo. Simple e fácil.</p>



        </article>
        <hr>
    

    <div class="pagination">
    
        <a class="btn pull-left" href="/blog/3">&larr; Older</a>
    

    
        <a class="btn pull-right" href="/blog/index.html">Newer &rarr;</a>
    
    </div>

                </div>

                
                <aside class="sidebar col-xs-12 col-md-4 col-lg-4">
                    <div class="row">

    
        <section class="hire--aside col-xs-12 col-sm-10 col-md-12">
            
    



    




<div class="hire hire--unavailable hire--vibrant">
    
        Not looking for new opportunities at this time
    
</div>


        </section>
    

    
<section class="social col-xs-12 col-sm-6 col-md-12">
    <h1>
        Follow me!
    </h1>
    <ul class="unstyled">
        
        
        
        
        <li><a class="github" href="//github.com/argerim"><i class="fa fa-github"></i> Github</a></li>
        
        
        
        <li><a class="linkedin" href="//linkedin.com/in/argerim"><i class="fa fa-linkedin-square"></i> LinkedIn</a></li>
        
        
        
        <li><a class="twitter" href="//twitter.com/argerimsf"><i class="fa fa-twitter"></i> Twitter</a></li>
        
    </ul>
</section>



    <section id="recent-posts" class="col-xs-12 col-sm-6 col-md-12">
    <h1>Recent Posts</h1>
    <ul class="divided">
        
        <li class="post">
            <a href="/blog/2015/09/18/rails-e-cloudinary/">Rails E Cloudinary</a>
        </li>
        
        <li class="post">
            <a href="/blog/2012/06/23/criando-e-manipulando-string-com-gsub-em-lua/">Criando E Manipulando String Com Gsub Em Lua</a>
        </li>
        
        <li class="post">
            <a href="/blog/2012/05/26/minha-mais-nova-gem-address-by-cep/">Minha Mais Nova Gem Address By Cep</a>
        </li>
        
        <li class="post">
            <a href="/blog/2012/05/15/cont-preenchendo-combobox-com-cidades-de-acordo-com-o-estado-selecionado-em-rails/">Cont Preenchendo ComboBox Com Cidades De Acordo Com O Estado Selecionado Em Rails</a>
        </li>
        
        <li class="post">
            <a href="/blog/2012/05/13/exibindo-versao-ruby-gemset-e-branch-atual-no-terminal/">Exibindo Versao Ruby Gemset E Branch Atual No Terminal</a>
        </li>
        
    </ul>
</section>

<section id="github-repos" class="col-xs-12 col-sm-6 col-md-12">
    <h1>
        GitHub Repos
        
        <small class="pull-right">
            <a class="btn" href="//github.com/argerim" title="@argerim on GitHub" target="_blank">
                <i class="fa fa-external-link"></i>
            </a>
        </small>
        
    </h1>
    <ul id="gh_repos" class="divided">
        <li class="loading">
            <i class="fa fa-spinner fa-spin"></i>
        </li>
    </ul>
</section>





<section id="twitter-timeline" class="col-xs-12 col-sm-6 col-md-12">
    <h1>
        Latest Tweets
        
        <small class="pull-right">
            <a class="btn" href="//twitter.com/argerimsf" title="@argerimsf on Twitter" target="_blank">
                <i class="fa fa-external-link"></i>
            </a>
        </small>
        
    </h1>

    <a class="twitter-timeline" data-dnt="true" href="//twitter.com/argerimsf"  data-widget-id="597899201150869504"  data-link-color="#049cdb" data-tweet-limit="" data-chrome="noheader nofooter transparent noscrollbar">Tweets by @argerimsf</a>
    <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+"://platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>
</section>



</div>

                </aside>
                
            </div>
        </div>

        

    
    




<footer class="footer">
    <div class="row middle-xs">
        
        <div class="col-xs-12 col-sm-6 col-md-6 col-lg-6">
            <p class="footer__copyright">
    All content copyright Rogerio Medeiros.<br>
    Code under <a href="//github.com/coogie/oscailte/blob/master/README.md">MIT Licence</a>.
</p>

        </div>
        
        
        <div class="col-xs-12 col-sm-6 col-md-6 col-lg-6">
            <div>
    



    




<div class="hire hire--unavailable hire--vibrant">
    
        Not looking for new opportunities at this time
    
</div>

</div>
        </div>
        
    </div>
</footer>


        <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.0/jquery.min.js"></script>
<script src="//crypto-js.googlecode.com/svn/tags/3.1.2/build/rollups/md5.js"></script>
<script defer src="/javascripts/octopress.js"></script>


<script>
    var _gaq=[['_setAccount','UA-29610246-1'],['_trackPageview']];
    (function(d,t){var g=d.createElement(t),s=d.getElementsByTagName(t)[0];
    g.src=('https:'==location.protocol?'//ssl':'//www')+'.google-analytics.com/ga.js';
    s.parentNode.insertBefore(g,s)}(document,'script'));
</script>



<script>
    var disqus_shortname = 'meubloglol';
    
        
        var disqus_script = 'count.js';
    
    (function () {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/' + disqus_script;
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>





<script>
    $(document).ready(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'argerim',
            count: 0,
            skip_forks: true,
            target: '#gh_repos'
        });
    });
</script>
<script src="/javascripts/github.js"></script>







    </body>

</html>
